import json

# JSON como cadena de texto
json_data = '''
[
        {
            "_id" : ObjectId("673b044b66dd775c91a709a9"),
            "lat" : -33.5419806,
            "lon" : -70.6365104,
            "loc" : [
                -70.6365104,
                -33.5419806
            ],
            "time" : ISODate("2024-11-18T06:09:31.111-0300"),
            "speed" : NumberInt(0)
        },
        {
            "_id" : ObjectId("673b04cf66dd775c91a74572"),
            "lat" : -33.5415068,
            "lon" : -70.6400348,
            "loc" : [
                -70.6400348,
                -33.5415068
            ],
            "time" : ISODate("2024-11-18T06:11:43.316-0300"),
            "speed" : 19.72034
        },
        {
            "_id" : ObjectId("673b04e566dd775c91a7497b"),
            "lat" : -33.5407746,
            "lon" : -70.6445854,
            "loc" : [
                -70.6445854,
                -33.5407746
            ],
            "time" : ISODate("2024-11-18T06:12:05.521-0300"),
            "speed" : 19.054163
        },
        {
            "_id" : ObjectId("673b04f466dd775c91a74c9d"),
            "lat" : -33.5401846,
            "lon" : -70.6479434,
            "loc" : [
                -70.6479434,
                -33.5401846
            ],
            "time" : ISODate("2024-11-18T06:12:20.960-0300"),
            "speed" : 21.146374
        },
        {
            "_id" : ObjectId("673b050d66dd775c91a7530b"),
            "lat" : -33.5391216,
            "lon" : -70.6541088,
            "loc" : [
                -70.6541088,
                -33.5391216
            ],
            "time" : ISODate("2024-11-18T06:12:45.501-0300"),
            "speed" : 22.796797
        },
        {
            "_id" : ObjectId("673b051c66dd775c91a7555b"),
            "lat" : -33.5391772,
            "lon" : -70.6582223,
            "loc" : [
                -70.6582223,
                -33.5391772
            ],
            "time" : ISODate("2024-11-18T06:13:00.641-0300"),
            "speed" : 24.653166
        },
        {
            "_id" : ObjectId("673b053066dd775c91a75878"),
            "lat" : -33.5379011,
            "lon" : -70.6668797,
            "loc" : [
                -70.6668797,
                -33.5379011
            ],
            "time" : ISODate("2024-11-18T06:13:20.756-0300"),
            "speed" : NumberInt(147)
        },
        {
            "_id" : ObjectId("673b055866dd775c91a75fcf"),
            "lat" : -33.5372447,
            "lon" : -70.6636416,
            "loc" : [
                -70.6636416,
                -33.5372447
            ],
            "time" : ISODate("2024-11-18T06:14:00.876-0300"),
            "speed" : NumberInt(28)
        },
        {
            "_id" : ObjectId("673b059f66dd775c91a78079"),
            "lat" : -33.5371877,
            "lon" : -70.6669292,
            "loc" : [
                -70.6669292,
                -33.5371877
            ],
            "time" : ISODate("2024-11-18T06:15:11.102-0300"),
            "speed" : 3.9038603
        },
        {
            "_id" : ObjectId("673b05bb66dd775c91a7910e"),
            "lat" : -33.5358918,
            "lon" : -70.6706626,
            "loc" : [
                -70.6706626,
                -33.5358918
            ],
            "time" : ISODate("2024-11-18T06:15:36.998-0300"),
            "speed" : 17.672401
        },
        {
            "_id" : ObjectId("673b05cc66dd775c91a79fa9"),
            "lat" : -33.533905,
            "lon" : -70.6744898,
            "loc" : [
                -70.6744898,
                -33.533905
            ],
            "time" : ISODate("2024-11-18T06:15:56.906-0300"),
            "speed" : NumberInt(79)
        },
        {
            "_id" : ObjectId("673b05db66dd775c91a7a396"),
            "lat" : -33.5337571,
            "lon" : -70.6781034,
            "loc" : [
                -70.6781034,
                -33.5337571
            ],
            "time" : ISODate("2024-11-18T06:16:11.738-0300"),
            "speed" : 17.818386
        },
        {
            "_id" : ObjectId("673b05ea66dd775c91a7a6b7"),
            "lat" : -33.5317468,
            "lon" : -70.6836438,
            "loc" : [
                -70.6836438,
                -33.5317468
            ],
            "time" : ISODate("2024-11-18T06:16:26.554-0300"),
            "speed" : NumberInt(144)
        },
        {
            "_id" : ObjectId("673b060366dd775c91a7ac83"),
            "lat" : -33.5275523,
            "lon" : -70.6906966,
            "loc" : [
                -70.6906966,
                -33.5275523
            ],
            "time" : ISODate("2024-11-18T06:16:51.770-0300"),
            "speed" : NumberInt(116)
        },
        {
            "_id" : ObjectId("673b062166dd775c91a7b368"),
            "lat" : -33.5255276,
            "lon" : -70.6940729,
            "loc" : [
                -70.6940729,
                -33.5255276
            ],
            "time" : ISODate("2024-11-18T06:17:21.810-0300"),
            "speed" : 11.501216
        },
        {
            "_id" : ObjectId("673b064966dd775c91a7bd7c"),
            "lat" : -33.5236064,
            "lon" : -70.6970903,
            "loc" : [
                -70.6970903,
                -33.5236064
            ],
            "time" : ISODate("2024-11-18T06:18:01.884-0300"),
            "speed" : 9.638406
        },
        {
            "_id" : ObjectId("673b068166dd775c91a7d36c"),
            "lat" : -33.5216761,
            "lon" : -70.699452,
            "loc" : [
                -70.699452,
                -33.5216761
            ],
            "time" : ISODate("2024-11-18T06:18:57.167-0300"),
            "speed" : 6.050722
        },
        {
            "_id" : ObjectId("673b06b666dd775c91a7ea5b"),
            "lat" : -33.5197221,
            "lon" : -70.7020397,
            "loc" : [
                -70.7020397,
                -33.5197221
            ],
            "time" : ISODate("2024-11-18T06:19:50.449-0300"),
            "speed" : 8.613113
        },
        {
            "_id" : ObjectId("673b06bb66dd775c91a7eb25"),
            "lat" : -33.5181161,
            "lon" : -70.7050812,
            "loc" : [
                -70.7050812,
                -33.5181161
            ],
            "time" : ISODate("2024-11-18T06:19:55.382-0300"),
            "speed" : NumberInt(300)
        },
        {
            "_id" : ObjectId("673b06d966dd775c91a7f00e"),
            "lat" : -33.5177476,
            "lon" : -70.7114814,
            "loc" : [
                -70.7114814,
                -33.5177476
            ],
            "time" : ISODate("2024-11-18T06:20:25.585-0300"),
            "speed" : NumberInt(71)
        },
        {
            "_id" : ObjectId("673b06ed66dd775c91a7f3a4"),
            "lat" : -33.5150274,
            "lon" : -70.70984,
            "loc" : [
                -70.70984,
                -33.5150274
            ],
            "time" : ISODate("2024-11-18T06:20:45.696-0300"),
            "speed" : NumberInt(61)
        },
        {
            "_id" : ObjectId("673b06f266dd775c91a7f45b"),
            "lat" : -33.516051,
            "lon" : -70.7173355,
            "loc" : [
                -70.7173355,
                -33.516051
            ],
            "time" : ISODate("2024-11-18T06:20:50.595-0300"),
            "speed" : NumberInt(634)
        },
        {
            "_id" : ObjectId("673b070166dd775c91a7f6eb"),
            "lat" : -33.5126343,
            "lon" : -70.7214115,
            "loc" : [
                -70.7214115,
                -33.5126343
            ],
            "time" : ISODate("2024-11-18T06:21:05.699-0300"),
            "speed" : NumberInt(129)
        },
        {
            "_id" : ObjectId("673b071566dd775c91a8019f"),
            "lat" : -33.508631,
            "lon" : -70.7243634,
            "loc" : [
                -70.7243634,
                -33.508631
            ],
            "time" : ISODate("2024-11-18T06:21:25.836-0300"),
            "speed" : NumberInt(94)
        },
        {
            "_id" : ObjectId("673b072e66dd775c91a809b6"),
            "lat" : -33.5059531,
            "lon" : -70.7298526,
            "loc" : [
                -70.7298526,
                -33.5059531
            ],
            "time" : ISODate("2024-11-18T06:21:50.960-0300"),
            "speed" : 32.681557
        },
        {
            "_id" : ObjectId("673b073966dd775c91a80b87"),
            "lat" : -33.5049984,
            "lon" : -70.7336691,
            "loc" : [
                -70.7336691,
                -33.5049984
            ],
            "time" : ISODate("2024-11-18T06:22:01.069-0300"),
            "speed" : 33.6008
        },
        {
            "_id" : ObjectId("673b075166dd775c91a80f6d"),
            "lat" : -33.5026257,
            "lon" : -70.7409476,
            "loc" : [
                -70.7409476,
                -33.5026257
            ],
            "time" : ISODate("2024-11-18T06:22:25.887-0300"),
            "speed" : 33.67907
        },
        {
            "_id" : ObjectId("673b075c66dd775c91a81139"),
            "lat" : -33.5002606,
            "lon" : -70.7429961,
            "loc" : [
                -70.7429961,
                -33.5002606
            ],
            "time" : ISODate("2024-11-18T06:22:36.396-0300"),
            "speed" : 36.14328
        },
        {
            "_id" : ObjectId("673b076666dd775c91a81332"),
            "lat" : -33.4978409,
            "lon" : -70.7449197,
            "loc" : [
                -70.7449197,
                -33.4978409
            ],
            "time" : ISODate("2024-11-18T06:22:46.553-0300"),
            "speed" : 31.211031
        },
        {
            "_id" : ObjectId("673b077566dd775c91a816e6"),
            "lat" : -33.4949821,
            "lon" : -70.7471267,
            "loc" : [
                -70.7471267,
                -33.4949821
            ],
            "time" : ISODate("2024-11-18T06:23:01.509-0300"),
            "speed" : 2.2334974
        },
        {
            "_id" : ObjectId("673b077f66dd775c91a81be3"),
            "lat" : -33.4920378,
            "lon" : -70.7474147,
            "loc" : [
                -70.7474147,
                -33.4920378
            ],
            "time" : ISODate("2024-11-18T06:23:11.329-0300"),
            "speed" : 36.65225
        },
        {
            "_id" : ObjectId("673b078566dd775c91a81d86"),
            "lat" : -33.4947862,
            "lon" : -70.7481053,
            "loc" : [
                -70.7481053,
                -33.4947862
            ],
            "time" : ISODate("2024-11-18T06:23:17.618-0300"),
            "speed" : NumberInt(187)
        },
        {
            "_id" : ObjectId("673b079366dd775c91a820a1"),
            "lat" : -33.4870298,
            "lon" : -70.7519282,
            "loc" : [
                -70.7519282,
                -33.4870298
            ],
            "time" : ISODate("2024-11-18T06:23:31.511-0300"),
            "speed" : 2.2724895
        },
        {
            "_id" : ObjectId("673b07a266dd775c91a824c5"),
            "lat" : -33.4836129,
            "lon" : -70.7533852,
            "loc" : [
                -70.7533852,
                -33.4836129
            ],
            "time" : ISODate("2024-11-18T06:23:46.557-0300"),
            "speed" : 36.765064
        },
        {
            "_id" : ObjectId("673b07b266dd775c91a82d1d"),
            "lat" : -33.4801364,
            "lon" : -70.7554314,
            "loc" : [
                -70.7554314,
                -33.4801364
            ],
            "time" : ISODate("2024-11-18T06:24:02.604-0300"),
            "speed" : 29.744583
        },
        {
            "_id" : ObjectId("673b07c066dd775c91a83120"),
            "lat" : -33.4775666,
            "lon" : -70.7567809,
            "loc" : [
                -70.7567809,
                -33.4775666
            ],
            "time" : ISODate("2024-11-18T06:24:16.380-0300"),
            "speed" : 16.510529
        },
        {
            "_id" : ObjectId("673b07d466dd775c91a83671"),
            "lat" : -33.4729691,
            "lon" : -70.7581989,
            "loc" : [
                -70.7581989,
                -33.4729691
            ],
            "time" : ISODate("2024-11-18T06:24:36.525-0300"),
            "speed" : NumberInt(95)
        },
        {
            "_id" : ObjectId("673b07ed66dd775c91a83ed0"),
            "lat" : -33.4696089,
            "lon" : -70.7608517,
            "loc" : [
                -70.7608517,
                -33.4696089
            ],
            "time" : ISODate("2024-11-18T06:25:01.644-0300"),
            "speed" : 8.161894
        },
        {
            "_id" : ObjectId("673b07f766dd775c91a840fe"),
            "lat" : -33.4668956,
            "lon" : -70.7618699,
            "loc" : [
                -70.7618699,
                -33.4668956
            ],
            "time" : ISODate("2024-11-18T06:25:11.649-0300"),
            "speed" : 25.505808
        },
        {
            "_id" : ObjectId("673b080b66dd775c91a8482e"),
            "lat" : -33.461875,
            "lon" : -70.7636019,
            "loc" : [
                -70.7636019,
                -33.461875
            ],
            "time" : ISODate("2024-11-18T06:25:31.682-0300"),
            "speed" : 29.427746
        },
        {
            "_id" : ObjectId("673b081a66dd775c91a84ce6"),
            "lat" : -33.4582999,
            "lon" : -70.7647198,
            "loc" : [
                -70.7647198,
                -33.4582999
            ],
            "time" : ISODate("2024-11-18T06:25:46.942-0300"),
            "speed" : 39.22948
        },
        {
            "_id" : ObjectId("673b082a66dd775c91a8500b"),
            "lat" : -33.4558972,
            "lon" : -70.7671326,
            "loc" : [
                -70.7671326,
                -33.4558972
            ],
            "time" : ISODate("2024-11-18T06:26:02.079-0300"),
            "speed" : 23.527325
        },
        {
            "_id" : ObjectId("673b083866dd775c91a852f9"),
            "lat" : -33.4535078,
            "lon" : -70.7697041,
            "loc" : [
                -70.7697041,
                -33.4535078
            ],
            "time" : ISODate("2024-11-18T06:26:16.904-0300"),
            "speed" : 20.972631
        },
        {
            "_id" : ObjectId("673b085c66dd775c91a85a4f"),
            "lat" : -33.4498016,
            "lon" : -70.7761351,
            "loc" : [
                -70.7761351,
                -33.4498016
            ],
            "time" : ISODate("2024-11-18T06:26:52.035-0300"),
            "speed" : 29.684734
        },
        {
            "_id" : ObjectId("673b088966dd775c91a86a3c"),
            "lat" : -33.4461834,
            "lon" : -70.7774349,
            "loc" : [
                -70.7774349,
                -33.4461834
            ],
            "time" : ISODate("2024-11-18T06:27:37.452-0300"),
            "speed" : NumberInt(34)
        },
        {
            "_id" : ObjectId("673b08a766dd775c91a8709a"),
            "lat" : -33.4501366,
            "lon" : -70.7761411,
            "loc" : [
                -70.7761411,
                -33.4501366
            ],
            "time" : ISODate("2024-11-18T06:28:07.357-0300"),
            "speed" : NumberInt(57)
        },
        {
            "_id" : ObjectId("673b08ac66dd775c91a871ad"),
            "lat" : -33.4461699,
            "lon" : -70.777428,
            "loc" : [
                -70.777428,
                -33.4461699
            ],
            "time" : ISODate("2024-11-18T06:28:12.416-0300"),
            "speed" : NumberInt(329)
        },
        {
            "_id" : ObjectId("673b08b166dd775c91a872d7"),
            "lat" : -33.4506186,
            "lon" : -70.7758777,
            "loc" : [
                -70.7758777,
                -33.4506186
            ],
            "time" : ISODate("2024-11-18T06:28:17.526-0300"),
            "speed" : NumberInt(371)
        },
        {
            "_id" : ObjectId("673b08b666dd775c91a87345"),
            "lat" : -33.4464708,
            "lon" : -70.7787469,
            "loc" : [
                -70.7787469,
                -33.4464708
            ],
            "time" : ISODate("2024-11-18T06:28:22.517-0300"),
            "speed" : NumberInt(479)
        },
        {
            "_id" : ObjectId("673b08c566dd775c91a875e2"),
            "lat" : -33.4447382,
            "lon" : -70.7819207,
            "loc" : [
                -70.7819207,
                -33.4447382
            ],
            "time" : ISODate("2024-11-18T06:28:37.622-0300"),
            "speed" : 18.621468
        },
        {
            "_id" : ObjectId("673b08d466dd775c91a87842"),
            "lat" : -33.4440548,
            "lon" : -70.7854264,
            "loc" : [
                -70.7854264,
                -33.4440548
            ],
            "time" : ISODate("2024-11-18T06:28:52.580-0300"),
            "speed" : 13.885378
        },
        {
            "_id" : ObjectId("673b092f66dd775c91a895f5"),
            "lat" : -33.4448706,
            "lon" : -70.7816552,
            "loc" : [
                -70.7816552,
                -33.4448706
            ],
            "time" : ISODate("2024-11-18T06:30:23.062-0300"),
            "speed" : 14.051728
        },
        {
            "_id" : ObjectId("673b094d66dd775c91a8a4f7"),
            "lat" : -33.4499905,
            "lon" : -70.7764256,
            "loc" : [
                -70.7764256,
                -33.4499905
            ],
            "time" : ISODate("2024-11-18T06:30:53.157-0300"),
            "speed" : 6.308167
        },
        {
            "_id" : ObjectId("673b097566dd775c91a8ad55"),
            "lat" : -33.4514844,
            "lon" : -70.7716662,
            "loc" : [
                -70.7716662,
                -33.4514844
            ],
            "time" : ISODate("2024-11-18T06:31:33.425-0300"),
            "speed" : 32.996788
        },
        {
            "_id" : ObjectId("673b097a66dd775c91a8aeb2"),
            "lat" : -33.4529688,
            "lon" : -70.7744131,
            "loc" : [
                -70.7744131,
                -33.4529688
            ],
            "time" : ISODate("2024-11-18T06:31:38.465-0300"),
            "speed" : NumberInt(219)
        },
        {
            "_id" : ObjectId("673b09a266dd775c91a8b509"),
            "lat" : -33.4560175,
            "lon" : -70.7747225,
            "loc" : [
                -70.7747225,
                -33.4560175
            ],
            "time" : ISODate("2024-11-18T06:32:18.595-0300"),
            "speed" : 23.622297
        },
        {
            "_id" : ObjectId("673b09ca66dd775c91a8be7f"),
            "lat" : -33.4579061,
            "lon" : -70.7783039,
            "loc" : [
                -70.7783039,
                -33.4579061
            ],
            "time" : ISODate("2024-11-18T06:32:58.920-0300"),
            "speed" : 20.056847
        },
        {
            "_id" : ObjectId("673b09ed66dd775c91a8caaa"),
            "lat" : -33.4581209,
            "lon" : -70.7817282,
            "loc" : [
                -70.7817282,
                -33.4581209
            ],
            "time" : ISODate("2024-11-18T06:33:33.973-0300"),
            "speed" : NumberInt(33)
        },
        {
            "_id" : ObjectId("673b0ae066dd775c91a918f9"),
            "lat" : -33.4591961,
            "lon" : -70.7862286,
            "loc" : [
                -70.7862286,
                -33.4591961
            ],
            "time" : ISODate("2024-11-18T06:37:36.804-0300"),
            "speed" : NumberInt(6)
        }
    ]

'''

# Ruta del archivo de texto donde se almacenarán las latitudes y longitudes
ruta_txt = 'Rngo vueltas vuelta.txt'

# Función para extraer latitudes y longitudes y escribir en el archivo de texto
def extraer_lat_lon(json_data, ruta_txt):
    data = json.loads(json_data)
    
    with open(ruta_txt, 'w') as f:
        for item in data:  
            sequence = item.get('sequence', 'Sin Secuencia')  # Obtiene la secuencia, si no existe usa 'Sin Secuencia'
            lat = item['lat']
            lon = item['lon']
            f.write(f'Paso {sequence}\n')
            f.write(f'  Set Location    {lat}     {lon}\n')
            f.write(f'  Sleep    3s\n')

# Llamar a la función para extraer y escribir los datos
extraer_lat_lon(json_data, ruta_txt)
